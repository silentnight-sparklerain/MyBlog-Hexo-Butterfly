---
title: 离散数学（6）：初等数论
categories:
  - Study
  - Math
comments: true
description: 离散数学第六部分：初等数论
series: 离散数学笔记
hide: true
mathjax: false
katex: true
highlight_shrink: true
cover: /img/posts/离散数学.avif
abbrlink: 762b2d73
date: 2025-12-01 00:00:00
updated: 2025-12-01 00:00:00
keywords:
top_img:
aside:
aplayer:
---

## 第19章 初等数论

### 19.1 素数

#### 1. 整除性 (Divisibility)
*   **定义**：设 $a, b$ 是两个整数，且 $b \neq 0$。如果存在整数 $c$ 使得 $a = bc$，则称 $a$ 被 $b$ **整除**，或 $b$ **整除** $a$。
*   **记作**：$b \mid a$。
    *   若 $b$ 不能整除 $a$，记作 $b \nmid a$。
*   **术语**：
    *   $a$ 称为 $b$ 的**倍数** (Multiple)。
    *   $b$ 称为 $a$ 的**因子** (Factor) 或**约数**。
*   **因子分类**：
    *   **平凡因子**：$1$ 和它自己。
    *   **真因子**：除平凡因子之外的因子。
*   **性质**：
    1.  $b \mid a \iff a \bmod b = 0$。
    2.  **传递性**：若 $a \mid b$ 且 $b \mid c$，则 $a \mid c$。
    3.  **线性组合**：若 $a \mid b$ 且 $a \mid c$，则对于任意整数 $x, y$，有 $a \mid (xb + yc)$。
    4.  若 $a \mid b$ 且 $b \mid a$，则 $a = \pm b$。
    5.  若 $a \mid b$ 且 $b \neq 0$，则 $|a| \le |b|$。

#### 2. 带余除法 (Division Algorithm)
*   **定理**：设 $a, b$ 是两个整数，且 $b \neq 0$，则存在**唯一**的整数 $q$ (商) 和 $r$ (余数)，使得：
    $$ a = qb + r, \quad 0 \le r < |b| $$
*   **记号**：$r = a \bmod b$。

#### 3. 素数与合数
*   **素数 (Prime Number)**：如果正整数 $a > 1$ 且**只能**被 1 和它自己整除。
*   **合数 (Composite Number)**：如果正整数 $a > 1$ 且不是素数（即除了 1 和自身外还有其他因子）。
*   **基石性质**：
    *   如果 $p$ 是素数且 $p \mid ab$，则必然有 $p \mid a$ 或者 $p \mid b$。
    *   **算术基本定理 (Fundamental Theorem of Arithmetic)**：任何大于 1 的整数 $a$ 都可以**唯一**地分解为素数的乘积（不计顺序）。
        $$ a = p_1^{r_1} p_2^{r_2} \dots p_k^{r_k} $$
        这称为 $a$ 的**素因子分解**或**标准分解式**。

#### 4. 素数的分布
*   **素数有无穷多个**：不存在最大的素数（欧几里得证明）。
*   **素数定理**：$\pi(n)$ 表示小于等于 $n$ 的素数个数。当 $n$ 很大时，$\pi(n)$ 近似等于 $\frac{n}{\ln n}$。
    $$ \lim_{n \to \infty} \frac{\pi(n)}{n / \ln n} = 1 $$
*   **判定范围定理**：如果 $a$ 是一个合数，则 $a$ 必有一个小于等于 $\sqrt{a}$ 的真因子。
    *   *应用*：要判断 $a$ 是否为素数，只需检验 $2$ 到 $\sqrt{a}$ 之间的素数是否能整除 $a$。
*   **埃拉托斯特尼筛法 (Sieve of Eratosthenes)**：一种找出一定范围内所有素数的算法（挖掉所有素数的倍数）。

#### 5. 梅森素数 (Mersenne Primes)
*   形如 $2^n - 1$ 的素数。
*   必要条件：若 $2^n - 1$ 是素数，则 $n$ 必须是素数（但反之不一定成立）。

### 19.2 最大公约数与最小公倍数

#### 1. 定义
*   **公因子**：既整除 $a$ 又整除 $b$ 的数。
*   **最大公约数 (GCD)**：所有公因子中最大的那个。记作 $\gcd(a, b)$ 或简写为 $(a, b)$。
*   **公倍数**：既是 $a$ 的倍数又是 $b$ 的倍数的数。
*   **最小公倍数 (LCM)**：所有正公倍数中最小的那个。记作 $\text{lcm}(a, b)$。
*   **关系**：$\gcd(a, b) \times \text{lcm}(a, b) = |ab|$。

#### 2. 欧几里得算法 (Euclidean Algorithm) / 辗转相除法
*   **核心原理**：$\gcd(a, b) = \gcd(b, a \bmod b)$。
*   **过程**：通过反复做带余除法，直到余数为 0，最后的除数就是最大公约数。
    $$ r_{k-2} = q_k r_{k-1} + r_k \quad (\text{最后} r_k \neq 0, r_{k+1}=0 \Rightarrow \gcd = r_k) $$

#### 3. 扩展欧几里得算法与贝祖等式
*   **定理 19.7**：设 $a, b$ 不全为 0，则存在整数 $x, y$ 使得：
    $$ \gcd(a, b) = xa + yb $$
*   **算法**：在做辗转相除法的过程中，通过回代，可以求出系数 $x$ 和 $y$。

#### 4. 互素 (Coprime / Relatively Prime)
*   **定义**：如果 $\gcd(a, b) = 1$，则称 $a$ 和 $b$ **互素**。
*   **充要条件**：$a, b$ 互素 $\iff$ 存在整数 $x, y$ 使得 $ax + by = 1$。
*   **重要性质**：如果 $a \mid bc$ 且 $\gcd(a, b) = 1$，则 $a \mid c$。

### 19.3 同余 (Congruence)

#### 1. 基本概念
*   **模 (Modulus)**：设 $m$ 是正整数。
*   **同余定义**：如果 $m \mid (a - b)$（即 $a$ 和 $b$ 除以 $m$ 的余数相同），则称 $a$ 与 $b$ 模 $m$ 同余。
*   **记作**：$a \equiv b \pmod m$。
*   **不同余**：记作 $a \not\equiv b \pmod m$。

#### 2. 同余的性质
*   **等价关系**：同余关系具有自反性、对称性、传递性。
*   **保运算性**：如果 $a \equiv b \pmod m$，$c \equiv d \pmod m$，则：
    1.  $a \pm c \equiv b \pm d \pmod m$
    2.  $ac \equiv bd \pmod m$
    3.  $a^k \equiv b^k \pmod m$ ($k$ 为非负整数)
    *   *注意*：除法不一定保持同余（除非除数与模互素）。

#### 3. 剩余类 (Residue Classes)
*   **$\mathbb{Z}_m$**：模 $m$ 的剩余类集合，包含 $\{0, 1, \dots, m-1\}$。
*   在 $\mathbb{Z}_m$ 上的加法和乘法都是模 $m$ 进行的。

#### 4. 应用实例
*   **大数求余**：利用同余的乘法和幂运算性质，将大数的运算转化为小数的运算。
*   **日期计算**：利用模 7 的同余性质计算星期几（公历的周期性）。

### 19.4 一次同余方程

#### 1. 定义
形如 $ax \equiv c \pmod m$ 的方程，其中 $x$ 是未知数。

#### 2. 解的判定 (定理 19.9)
设 $d = \gcd(a, m)$。
*   方程**有解**的充要条件是：$d \mid c$ （即 $c$ 是 $a$ 和 $m$ 最大公约数的倍数）。
*   如果有解，则在模 $m$ 下恰有 **$d$ 个**不通的解。
*   **特别地**：如果 $\gcd(a, m) = 1$，则方程有**唯一解**。

#### 3. 模逆 (Modular Inverse)
*   **定义**：如果 $ab \equiv 1 \pmod m$，则称 $b$ 是 $a$ 的**模 $m$ 逆**。记作 $a^{-1} \pmod m$。
    *   *通俗理解*：同余世界里的“倒数”。
*   **存在条件**：$a$ 存在模 $m$ 逆 $\iff \gcd(a, m) = 1$（$a, m$ 互素）。
*   **求逆方法**：
    1.  **扩展欧几里得法**：求解 $ax + my = 1$，则 $x$ 就是 $a^{-1}$。
    2.  **欧拉定理/费马小定理**（见下节）。

#### 4. 解方程的方法
要解 $ax \equiv c \pmod m$：
1.  先求 $a$ 的逆 $a^{-1}$。
2.  两边同乘 $a^{-1}$，得到 $x \equiv a^{-1}c \pmod m$。

### 19.5 欧拉定理和费马小定理

#### 1. 欧拉函数 (Euler's Totient Function)
*   **定义**：$\phi(n)$ 表示小于 $n$ 且与 $n$ **互素**的正整数的个数。
    *   例：$\phi(1) = 1$。
    *   对于素数 $p$，$\phi(p) = p - 1$。
*   **计算公式**：
    若 $n = p_1^{r_1} p_2^{r_2} \dots p_k^{r_k}$，则
    $$ \phi(n) = n \left(1 - \frac{1}{p_1}\right) \left(1 - \frac{1}{p_2}\right) \dots \left(1 - \frac{1}{p_k}\right) $$

#### 2. 欧拉定理 (Euler's Theorem)
*   **内容**：设 $a, n$ 是互素的正整数（$\gcd(a, n)=1$），则：
    $$ a^{\phi(n)} \equiv 1 \pmod n $$
*   **作用**：用于降幂运算，或者求模逆（$a^{-1} \equiv a^{\phi(n)-1} \pmod n$）。

#### 3. 费马小定理 (Fermat's Little Theorem)
这是欧拉定理在模为素数时的特例。
*   **内容**：设 $p$ 是素数。
    1.  若 $p \nmid a$（即 $a$ 不是 $p$ 的倍数），则 $a^{p-1} \equiv 1 \pmod p$。
    2.  对于任意整数 $a$，都有 $a^p \equiv a \pmod p$。

### 19.6 初等数论在计算机科学技术中的几个应用

#### 1. 产生均匀伪随机数
*   **线性同余法**：
    $$ x_n = (ax_{n-1} + c) \bmod m $$
    *   $x_0$：种子 (Seed)。
    *   $a$：乘数。
    *   $c$：增量。
    *   $m$：模数。
*   生成的序列虽然是确定性的，但在统计上具有随机性，称为**伪随机数**。

#### 2. 密码学基础
*   **凯撒密码 (Caesar Cipher)**：简单的移位，$E(x) = (x + k) \bmod 26$。
*   **仿射密码**：$E(x) = (ax + b) \bmod 26$。解密需要求 $a$ 的逆。

#### 3. RSA 公钥密码体制
利用大数分解困难性的非对称加密算法。

*   **密钥生成步骤**：
    1.  选两个大素数 $p, q$。
    2.  计算 $n = pq$。
    3.  计算欧拉函数 $\phi(n) = (p-1)(q-1)$。
    4.  选一个整数 $e$（公钥指数），满足 $1 < e < \phi(n)$ 且 $\gcd(e, \phi(n)) = 1$。
    5.  计算 $d$（私钥指数），使得 $ed \equiv 1 \pmod{\phi(n)}$ （即 $d$ 是 $e$ 的模逆）。
*   **公钥**：$(e, n)$ —— 公开给所有人。
*   **私钥**：$(d, n)$ —— 自己保密。
*   **加密过程**：
    将明文 $M$ 转化为整数（$M < n$），密文 $C$ 计算为：
    $$ C = M^e \bmod n $$
*   **解密过程**：
    收到密文 $C$，恢复明文 $M$：
    $$ M = C^d \bmod n $$

#### 4. 模幂算法 (Square and Multiply)
*   **问题**：RSA加密解密需要计算很大的 $M^e \bmod n$，直接乘会溢出且太慢。
*   **快速模幂法**：
    将指数 $e$ 表示为二进制形式，通过反复的**平方**和**乘法**并同时**取模**，将时间复杂度从线性级降低到对数级。