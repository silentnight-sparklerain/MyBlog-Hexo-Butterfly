---
title: 离散数学（5）：图论
categories:
  - Study
  - Math
comments: true
description: 离散数学第五部分：图论
series: 离散数学笔记
hide: true
mathjax: false
katex: true
highlight_shrink: true
cover: /img/posts/离散数学.avif
abbrlink: b8b0e8d4
date: 2025-11-30 00:00:00
updated: 2025-11-30 00:00:00
keywords:
top_img:
aside:
aplayer:
---

## 第14章 图的基本概念

### 14.1 图

#### 1. 无序积与图的定义
*   **无序积 (Unordered Product)**：
    设 $A, B$ 为任意两个集合，称 $\{\{a, b\} \mid a \in A \land b \in B\}$ 为 $A$ 与 $B$ 的无序积，记作 $A \& B$。
    *   **无序对**：$\{a, b\}$ 记为 $(a, b)$，且 $(a, b) = (b, a)$。允许 $a=b$。
    *   **性质**：$A \& B = B \& A$。

*   **无向图 (Undirected Graph)**：
    一个无向图 $G$ 是一个有序的二元组 $\langle V, E \rangle$，其中：
    1.  $V$ 是一个**非空有穷集**，称为**顶点集** (Vertex Set)，元素称为**顶点** (Vertex) 或**结点**。
    2.  $E$ 是无序积 $V \& V$ 的**有穷多重子集**，称为**边集** (Edge Set)，元素称为**无向边**，简称**边**。

*   **有向图 (Directed Graph)**：
    一个有向图 $D$ 是一个有序的二元组 $\langle V, E \rangle$，其中：
    1.  $V$ 同定义 14.1（非空有穷顶点集）。
    2.  $E$ 是笛卡儿积 $V \times V$ 的**有穷多重子集**，称为**边集**，元素称为**有向边**，简称**边**。
    *   **表示**：无向边用圆括号 $(u, v)$ 表示；有向边用尖括号 $\langle u, v \rangle$ 表示，从 $u$ 指向 $v$。

#### 2. 图的基本术语
*   **阶 (Order)**：顶点集 $V$ 的元素个数，即 $|V|$，称 $G$ 为 $n$ 阶图。
*   **边数 (Size)**：边集 $E$ 的元素个数，即 $|E|$，通常记为 $m$。
*   **零图 (Null Graph)**：一条边也没有的图。
    *   $n$ 阶零图记作 $N_n$。
    *   1 阶零图 $N_1$ 称为**平凡图** (Trivial Graph)。
*   **空图**：顶点集 $V$ 为空集的图（根据定义通常 $V$ 非空，但在运算中可能出现），记作 $\varnothing$。
*   **标定图与非标定图**：如果给顶点和边指定了具体的符号（名字），则为标定图；否则为非标定图。
*   **基图 (Underlying Graph)**：将有向图的所有有向边改为无向边，并去重（如果有重边的话），得到的无向图。

#### 3. 顶点与边的关系
设 $e_k = (u, v) \in E$（无向）或 $e_k = \langle u, v \rangle \in E$（有向）：
*   **端点**：$u, v$ 称为边 $e_k$ 的端点。
*   **关联 (Incidence)**：边 $e_k$ 与端点 $u, v$ 关联。
    *   **关联次数**：
        *   若 $u \neq v$，关联次数为 1。
        *   若 $u = v$（环），关联次数为 2。
        *   若顶点与边不关联，次数为 0。
*   **相邻 (Adjacency)**：
    *   **点与点**：若两个顶点由一条边连接，称这两个顶点相邻。
    *   **边与边**：若两条边至少有一个公共端点，称这两条边相邻。
*   **环 (Loop)**：两端点重合的边（即 $(v, v)$ 或 $\langle v, v \rangle$）。
*   **孤立点 (Isolated Vertex)**：没有边与之关联的顶点。
*   **邻域 (Neighborhood)**：
    *   **邻域** $N_G(v)$：与顶点 $v$ 相邻的所有顶点组成的集合。
    *   **闭邻域** $\bar{N}_G(v)$：$N_G(v) \cup \{v\}$。
    *   对于有向图：
        *   **后继元集** $\Gamma^+_D(v)$：从 $v$ 出发能直接到达的顶点集。
        *   **先驱元集** $\Gamma^-_D(v)$：直接指向 $v$ 的顶点集。
*   **重数与重图**：
    *   **平行边 (Parallel Edges)**：关联一对顶点的边多于 1 条（有向图中需方向相同）。
    *   **重数**：平行边的条数。
    *   **多重图 (Multigraph)**：含平行边的图。
    *   **简单图 (Simple Graph)**：既不含平行边也不含环的图。

#### 4. 顶点的度数 (Degree)
*   **度数定义**：
    *   **无向图**：顶点 $v$ 作为边的端点的次数，记为 $d_G(v)$ 或 $d(v)$。
        *   *注意*：环给顶点贡献 2 度。
    *   **有向图**：
        *   **出度** $d^+(v)$：以 $v$ 为始点的边数。
        *   **入度** $d^-(v)$：以 $v$ 为终点的边数。
        *   **度** $d(v) = d^+(v) + d^-(v)$。
        *   *注意*：环给入度和出度各贡献 1 度，总度数贡献 2 度。
*   **最值记号**：
    *   最大度 $\Delta(G)$，最小度 $\delta(G)$。
    *   最大出度 $\Delta^+$，最大入度 $\Delta^-$；最小出度 $\delta^+$，最小入度 $\delta^-$。
*   **特殊顶点**：
    *   **悬挂顶点**：度数为 1 的顶点。
    *   **悬挂边**：与悬挂顶点关联的边。
    *   **奇/偶顶点**：度数为奇数/偶数的顶点。

#### 5. 握手定理 (Handshaking Lemma)
*   **无向图**：所有顶点的度数之和等于边数的 2 倍。
    $$ \sum_{v \in V} d(v) = 2|E| $$
*   **有向图**：所有顶点的度数之和等于边数的 2 倍；且所有顶点的入度之和等于出度之和，等于边数。
    $$ \sum_{v \in V} d(v) = 2|E| $$
    $$ \sum_{v \in V} d^+(v) = \sum_{v \in V} d^-(v) = |E| $$
*   **推论**：任何图（无向或有向）中，**奇度顶点的个数必定是偶数**。

#### 6. 可图化与度数序列
*   **度数序列**：将图 $G$ 中所有顶点的度数排列成一个非负整数序列 $d = (d_1, d_2, \dots, d_n)$。
*   **可图化 (Graphic)**：如果一个非负整数序列是某个无向图的度数序列，称该序列是可图化的。
*   **可简单图化**：如果该序列是某个**简单图**的度数序列。
*   **判定可图化**：序列 $d$ 可图化的充要条件是 $\sum d_i$ 为偶数。
*   **Havel-Hakimi 定理 - 判定可简单图化**：
    设非负整数序列 $d = (d_1, d_2, \dots, d_n)$ 且满足 $d_1 \ge d_2 \ge \dots \ge d_n$，则 $d$ 可简单图化当且仅当新序列
    $$ d' = (d_2 - 1, d_3 - 1, \dots, d_{d_1 + 1} - 1, d_{d_1 + 2}, \dots, d_n) $$
    可简单图化。
    *   *解释*：把最大的度数 $d_1$ 删掉，然后给它后面的 $d_1$ 个数每个减 1，看剩下的序列是否可简单图化。

#### 7. 图的同构 (Isomorphism)
*   **定义**：设两个无向图 $G_1=\langle V_1, E_1 \rangle$ 和 $G_2=\langle V_2, E_2 \rangle$。若存在双射函数 $f: V_1 \to V_2$，使得对于任意 $u, v \in V_1$，边 $(u, v) \in E_1$ 的重数等于边 $(f(u), f(v)) \in E_2$ 的重数，则称 $G_1$ 与 $G_2$ 同构，记作 $G_1 \cong G_2$。
*   **必要条件**（用于证明不同构）：
    *   顶点数相同。
    *   边数相同。
    *   度数序列相同。
    *   如果不满足以上任意一条，则不同构；满足了也不一定同构（需验证邻接关系）。

#### 8. 几类特殊的图
*   **完全图 (Complete Graph)**：
    *   **无向完全图 $K_n$**：每两个不同的顶点之间都有一条边。边数为 $n(n-1)/2$。
    *   **有向完全图**：每两个不同顶点之间都有且仅有一条有向边。
*   **竞赛图**：基图是 $K_n$ 的有向图（即 $n$ 个队伍两两比赛，必有胜负）。
*   **正则图 (Regular Graph)**：所有顶点的度数都为 $k$ 的图，称为 $k$-正则图。
    *   $N_n$ 是 0-正则图。
    *   $K_n$ 是 $(n-1)$-正则图。
    *   *性质*：$n$ 阶 $k$-正则图的边数为 $nk/2$。若 $k$ 为奇数，则 $n$ 必须为偶数。
*   **二部图 (Bipartite Graph)**（见14.3节定义，此处补充）：
    *   顶点集 $V$ 可以划分为两个互不相交的子集 $V_1, V_2$，使得每一条边的一个端点在 $V_1$ 中，另一个在 $V_2$ 中。
    *   **完全二部图 $K_{r, s}$**：$V_1$ 中每个顶点与 $V_2$ 中每个顶点都有边相连 ($|V_1|=r, |V_2|=s$)。

#### 9. 子图与补图
*   **子图 (Subgraph)**：
    设 $G=\langle V, E \rangle, G'=\langle V', E' \rangle$。若 $V' \subseteq V$ 且 $E' \subseteq E$，称 $G'$ 是 $G$ 的子图，记作 $G' \subseteq G$。
    *   **真子图**：$G' \subseteq G$ 且 $G' \neq G$。
    *   **生成子图 (Spanning Subgraph)**：$V' = V$（顶点全在，只删边）。
    *   **导出子图 (Induced Subgraph)**：
        *   **点导出子图 $G[V']$**：选中顶点集 $V'$，保留 $G$ 中两端点都在 $V'$ 中的所有边。
        *   **边导出子图 $G[E']$**：选中边集 $E'$，顶点集为 $E'$ 中所有边的端点。
*   **补图 (Complement Graph)**：
    设 $G=\langle V, E \rangle$ 为 $n$ 阶无向简单图。
    *   **定义**：以 $V$ 为顶点集，以所有**不属于** $G$ 但属于 $K_n$（完全图）的边为边集的图，记作 $\bar{G}$。
    *   **性质**：$G \cup \bar{G} = K_n$, $G \cap \bar{G} = N_n$。
*   **删除运算**：
    *   **删边 $G-e$**：去掉边 $e$。
    *   **删点 $G-v$**：去掉顶点 $v$ **以及**所有与 $v$ 关联的边。

### 14.2 通路与回路

#### 1. 通路与回路的定义
设 $G$ 为无向或有向图，序列 $\Gamma = v_0 e_1 v_1 e_2 \dots e_l v_l$ 是顶点与边的交替序列。
*   **通路 (Walk)**：$v_0$ 到 $v_l$ 的交替序列。$l$ 为通路的**长度**（边的条数）。
*   **分类体系**（注意术语的区别）：
    1.  **简单通路 (Trail)**：所有的**边**互不相同。
    2.  **初级通路 / 路径 (Path)**：所有的**顶点**互不相同（除起点终点可能重合外）。
        *   *注*：初级通路一定是简单通路。
    3.  **回路 (Circuit)**：起点等于终点 ($v_0 = v_l$) 的简单通路（边不重复）。
    4.  **初级回路 / 圈 (Cycle)**：起点等于终点 ($v_0 = v_l$) 的初级通路（除首尾外顶点不重复）。
        *   **奇圈/偶圈**：长度为奇数/偶数的圈。
*   **定理**：如果在图中存在从 $u$ 到 $v$ 的通路，则必存在从 $u$ 到 $v$ 的**初级通路**（路径）。
    *   *同理*：若有 $v$ 到自身的回路，则必有 $v$ 到自身的初级回路（圈）。

### 14.3 图的连通性

#### 1. 无向图的连通性
*   **连通 (Connected)**：若顶点 $u, v$ 之间存在通路，称 $u, v$ 是连通的，记作 $u \sim v$。
    *   这一关系是等价关系（自反、对称、传递）。
*   **连通图**：任意两个顶点都连通的图。否则称为**非连通图**。
*   **连通分支 (Connected Component)**：非连通图中的极大连通子图，记作 $p(G)$ 为连通分支数。
*   **距离 (Distance)**：
    *   $d(u, v)$：$u, v$ 之间**长度最短**的通路的长度（称为**短程线**）。
    *   若不连通，距离为 $\infty$。
    *   **性质**：满足非负性、对称性、三角不等式 ($d(u,v) + d(v,w) \ge d(u,w)$)。

#### 2. 有向图的连通性
*   **可达 (Reachable)**：若存在从 $u$ 到 $v$ 的有向通路，称 $u$ 可达 $v$（记作 $u \to v$）。
*   **相互可达**：$u \to v$ 且 $v \to u$。
*   **连通性分类**：
    1.  **弱连通图 (Weakly Connected)**：基图（去掉方向后的无向图）是连通的。
    2.  **单向连通图 (Unilaterally Connected)**：任意两点 $u, v$，至少存在单向通路（$u \to v$ 或 $v \to u$）。
    3.  **强连通图 (Strongly Connected)**：任意两点 $u, v$，均互相可达。
*   **判别定理**：有向图是强连通的 $\Leftrightarrow$ 图中包含一条经过所有顶点的回路。

#### 3. 割集与连通度
用于衡量图的“脆弱”程度。
*   **点割集 (Vertex Cut)**：
    *   **割点 (Cut Vertex)**：删去该点（及关联边）后，图的连通分支数增加。
    *   **点割集**：删去集合 $V'$ 中的点后，图变得不连通或变成平凡图。
    *   **点连通度 $\kappa(G)$**：为了让图不连通或变成平凡图，**最少**需要删除的顶点数。
        *   不连通图：$\kappa = 0$。
        *   有割点：$\kappa = 1$。
        *   完全图 $K_n$：$\kappa = n-1$。
*   **边割集 (Edge Cut)**：
    *   **割边 / 桥 (Bridge)**：删去该边后，图的连通分支数增加。
    *   **边割集**：删去集合 $E'$ 中的边后，图变得不连通。
    *   **边连通度 $\lambda(G)$**：为了让图不连通，**最少**需要删除的边数。
*   **重要不等式**：
    $$ \kappa(G) \le \lambda(G) \le \delta(G) $$
    (点连通度 $\le$ 边连通度 $\le$ 最小度)

#### 4. 二部图的判别
*   **定理**：一个无向图是二部图 $\Leftrightarrow$ 该图中**不含奇数长度的圈**（无奇圈）。

### 14.4 图的矩阵表示

#### 1. 关联矩阵 (Incidence Matrix) $M(G)$
描述顶点与边的关联关系。设 $n$ 个顶点，$m$ 条边。矩阵大小为 $n \times m$。
*   **无向图**：
    *   $m_{ij} = 1$：顶点 $v_i$ 与边 $e_j$ 关联。
    *   $m_{ij} = 0$：不关联。
    *   *性质*：每一列的和为 2（每条边有两个端点，环的情况特殊定义通常视作关联两次或单独处理，教材中环通常记为0或2需依据上下文，一般简单图无环）。每一行的和为该顶点的度数。
*   **有向图**：
    *   $m_{ij} = 1$：$v_i$ 是 $e_j$ 的始点。
    *   $m_{ij} = -1$：$v_i$ 是 $e_j$ 的终点。
    *   $m_{ij} = 0$：不关联（或环）。
    *   *性质*：每一列和为 0（非环边一进一出）。

#### 2. 邻接矩阵 (Adjacency Matrix) $A(G)$
描述顶点之间的邻接关系。矩阵大小为 $n \times n$。
*   **定义**：$a_{ij}$ 表示从 $v_i$ 到 $v_j$ 的边的条数。
    *   无向图：$A$ 是对称矩阵。$a_{ij} = 1$ (或边数)。
    *   有向图：$a_{ij} = 1$ (若有边 $v_i \to v_j$)。
*   **性质（重要）**：
    *   $A^l$（矩阵的 $l$ 次方）中第 $i$ 行第 $j$ 列的元素 $a^{(l)}_{ij}$，等于从 $v_i$ 到 $v_j$ **长度恰好为 $l$** 的通路总数。
    *   利用 $A, A^2, \dots, A^{n-1}$ 可以判断连通性。

#### 3. 可达矩阵 (Reachability Matrix) $P(G)$
描述节点间的可达性。矩阵大小为 $n \times n$。
*   **定义**：
    *   $p_{ij} = 1$：若 $v_i$ 可达 $v_j$。
    *   $p_{ij} = 0$：不可达。
*   **计算**：
    *   $P = A \lor A^{(2)} \lor \dots \lor A^{(n)}$ （布尔加法）。
    *   也可以使用 **Warshall 算法** 高效计算。

### 14.5 图的运算

设 $G_1 = \langle V_1, E_1 \rangle, G_2 = \langle V_2, E_2 \rangle$。

1.  **并 (Union)**：
    *   $G_1 \cup G_2 = \langle V_1 \cup V_2, E_1 \cup E_2 \rangle$。
    *   若 $V_1 \cap V_2 = \varnothing$，称为**不交并**。
2.  **交 (Intersection)**：
    *   $G_1 \cap G_2 = \langle V_1 \cap V_2, E_1 \cap E_2 \rangle$。
    *   仅当 $V_1 \cap V_2 \neq \varnothing$ 时有意义。
3.  **差 (Difference)**：
    *   $G_1 - G_2$：边集为 $E_1 - E_2$，顶点集为 $E_1 - E_2$ 中边关联的顶点（通常定义为保留原 $G_1$ 的顶点或仅保留关联顶点，教材中定义为：以 $V_1$ 为顶点，删去 $E_1$ 中属于 $E_2$ 的边。更严格的集合定义是 $E_1 - E_2$ 导出的子图）。
    *   *教材定义*：$G_1 - G_2$ 是以 $E_1 - E_2$ 为边集，以 $E_1 - E_2$ 中边关联的顶点组成的集合为顶点集的图（即差集的导出子图）。
4.  **环和 (Ring Sum)**：
    *   $G_1 \oplus G_2 = (G_1 \cup G_2) - (G_1 \cap G_2)$。
    *   即保留只在 $G_1$ 或只在 $G_2$ 中出现的边（对称差）。

## 第15章 欧拉图与哈密顿图

### 15.1 欧拉图

#### 1. 基本定义
*   **欧拉通路 (Eulerian Trail)**：通过图（无向图或有向图）中**所有边一次且仅一次**行遍所有顶点的通路。
*   **欧拉回路 (Eulerian Circuit)**：通过图（无向图或有向图）中**所有边一次且仅一次**行遍所有顶点的回路。
*   **欧拉图 (Eulerian Graph)**：具有欧拉回路的图。
    *   *规定*：平凡图（只有1个顶点）是欧拉图。
*   **半欧拉图 (Semi-Eulerian Graph)**：具有欧拉通路而无欧拉回路的图。

#### 2. 无向图的判定定理
*   **欧拉图判定**：
    无向图 $G$ 是欧拉图当且仅当 $G$ 是**连通图**且**没有奇度顶点**（即所有顶点的度数均为偶数）。
*   **半欧拉图判定**：
    无向图 $G$ 是半欧拉图当且仅当 $G$ 是**连通图**且**恰有两个奇度顶点**。
    *   *注*：欧拉通路的起点和终点必为这两个奇度顶点。

#### 3. 有向图的判定定理
*   **欧拉图判定**：
    有向图 $D$ 是欧拉图当且仅当 $D$ 是**强连通**的且每个顶点的**入度等于出度**。
    $$ \forall v \in V, d^+(v) = d^-(v) $$
*   **半欧拉图判定**：
    有向图 $D$ 是半欧拉图当且仅当 $D$ 是**单向连通**的，且满足以下条件：
    1.  恰有一个顶点 $u$ 的出度比入度大 1（起点）：$d^+(u) - d^-(u) = 1$。
    2.  恰有一个顶点 $v$ 的入度比出度大 1（终点）：$d^-(v) - d^+(v) = 1$。
    3.  其余所有顶点的入度等于出度。

#### 4. 结构性质与求法
*   **定理**：$G$ 是非平凡的欧拉图当且仅当 $G$ 是连通的且是若干个**边不重**的圈的并。
*   **Fleury 算法 (求欧拉回路)**：
    *   **核心思想**：“不走桥”。
    *   在当前顶点的所有可选边中，除非没有别的边可走，否则**不要走桥**（走桥会使得剩下的图不连通，导致无法走完剩余的边）。

### 15.2 哈密顿图

#### 1. 基本定义
*   **哈密顿通路 (Hamiltonian Path)**：经过图（有向或无向）中**所有顶点一次且仅一次**的通路。
*   **哈密顿回路 (Hamiltonian Cycle)**：经过图（有向或无向）中**所有顶点一次且仅一次**的回路。
*   **哈密顿图 (Hamiltonian Graph)**：具有哈密顿回路的图。
*   **半哈密顿图 (Semi-Hamiltonian Graph)**：具有哈密顿通路但无哈密顿回路的图。
    *   *规定*：平凡图是哈密顿图。

#### 2. 必要条件 (判定不是哈密顿图)
*   **哈密顿图的必要条件**：
    设无向图 $G = \langle V, E \rangle$ 是哈密顿图，则对于任意非空子集 $V_1 \subset V$，有：
    $$ p(G - V_1) \le |V_1| $$
    即：删除 $V_1$ 中的顶点后，剩下的图的连通分支数不超过 $|V_1|$。
*   **半哈密顿图的必要条件**：
    设无向图 $G$ 是半哈密顿图，则对于任意非空子集 $V_1 \subset V$，有：
    $$ p(G - V_1) \le |V_1| + 1 $$
*   *注意*：这些条件是必要的但不是充分的（即满足该条件的图不一定是哈密顿图）。

#### 3. 充分条件 (判定是哈密顿图)
对于 $n$ 阶无向简单图 ($n \ge 3$)：

*   **哈密顿通路判定**：
    若对于 $G$ 中任意不相邻的顶点 $u, v$，均有：
    $$ d(u) + d(v) \ge n - 1 $$
    则 $G$ 中存在哈密顿通路。
*   **哈密顿回路判定 - Ore 定理**：
    若对于 $G$ 中任意不相邻的顶点 $u, v$，均有：
    $$ d(u) + d(v) \ge n $$
    则 $G$ 是哈密顿图（存在哈密顿回路）。
    *   **推论 (Dirac 定理)**：若 $G$ 中所有顶点的度数都满足 $d(v) \ge n/2$，则 $G$ 是哈密顿图。

#### 4. 竞赛图的性质
*   **定理**：$n (n \ge 2)$ 阶竞赛图（有向完全图）中都有哈密顿通路。

### 15.3 最短路问题、中国邮递员问题与货郎担问题

#### 1. 带权图与最短路
*   **带权图 (Weighted Graph)**：每条边 $e$ 都有一个实数值 $W(e)$（称为权）的图，记作 $G = \langle V, E, W \rangle$。
*   **通路/回路的长度**：通路或回路中所有边的权之和。
*   **最短路径问题**：求两个顶点 $u, v$ 之间长度最短的路径。
*   **Dijkstra 标号法**：
    *   用于求解非负权图的单源最短路径。
    *   **基本思想**：给每个顶点 $v$ 维护一个标号 $l(v)$，表示从起点 $s$ 到 $v$ 的当前最短距离。
    *   分为**P标号**（永久标号，已确定最短路）和**T标号**（临时标号，待优化）。每次选取T标号最小的顶点转为P标号，并更新其邻居的T标号。

#### 2. 中国邮递员问题 (Chinese Postman Problem, CPP)
*   **问题描述**：在带权图中，寻找一条包含每条边至少一次的回路，使得回路的总权值最小。
*   **解法逻辑**：
    *   若 $G$ 是欧拉图：任一条欧拉回路即为解（每条边只走一次，权重和即所有边权重之和）。
    *   若 $G$ 不是欧拉图：存在奇度顶点。需要在奇度顶点之间**重复走某些边**。问题转化为在奇度顶点之间寻找路径进行“重复覆盖”，使得增加的权重最小，从而将图转化为欧拉图。

#### 3. 货郎担问题 / 旅行商问题 (Traveling Salesman Problem, TSP)
*   **问题描述**：一个旅行商要拜访 $n$ 个城市，每个城市去且只去一次，最后回到出发点，求总路程最短的路线。
*   **数学本质**：在带权图中寻找一条权值最小的**哈密顿回路**。
*   **难度**：这是一个 NP 难问题，目前尚未找到有效的多项式时间算法，通常使用近似算法或启发式算法求解。

## 第16章 树

### 16.1 无向树及其性质

#### 1. 基本定义
*   **无向树 (Tree)**：连通且**无回路**的无向图，简称**树**。
*   **森林 (Forest)**：每个连通分支都是树的无向图（即无回路的无向图）。
    *   *注*：森林是若干棵互不相连的树的集合。
*   **平凡树**：只有一个顶点的树（平凡图）。
*   **树叶 (Leaf)**：在无向树中，度数为 1 的顶点。
*   **分支点**：在无向树中，度数大于等于 2 的顶点。

#### 2. 树的等价定义（六个充要条件）
设 $G = \langle V, E \rangle$ 是 $n$ 阶 $m$ 条边的无向图，以下 6 个命题是等价的（即只要满足其中一个，$G$ 就是树）：
1.  $G$ 是树（连通且无回路）。
2.  $G$ 中任意两个顶点之间存在**唯一**的路径。
3.  $G$ 中无回路且 $m = n - 1$。
    *   *解释*：边数比顶点数少 1，且没圈。
4.  $G$ 是连通的且 $m = n - 1$。
    *   *解释*：边数比顶点数少 1，且连在一起。
5.  $G$ 是连通的且任何边均为**桥**。
    *   *解释*：删掉任意一条边，图就不连通了。
6.  $G$ 中没有回路，但在任何两个不同的顶点之间加一条新边后，图中有**唯一**的一个含新边的圈。

#### 3. 树的度数性质
*   **定理 16.2**：设 $T$ 是 $n$ 阶非平凡的无向树（$n \ge 2$），则 $T$ 中**至少有两片树叶**。
*   **度数公式**：
    $$ \sum_{v \in V} d(v) = 2(n - 1) $$
    *   *推导*：根据握手定理，度数和 = 2倍边数。树的边数 $m = n-1$，所以度数和是 $2(n-1)$。

#### 4. 星形图
*   **定义**：只有一个分支点，且该分支点的度数为 $n-1$ 的 $n$ 阶 ($n \ge 3$) 无向树。其唯一分支点称为**星心**。
*   即一个中心点连接周围所有其他点。

### 16.2 生成树

#### 1. 生成树的概念
*   **生成树 (Spanning Tree)**：若无向图 $G$ 的生成子图 $T$ 是树，则称 $T$ 是 $G$ 的生成树。
    *   即：包含 $G$ 中**所有顶点**，但边集是 $G$ 边集的子集，且构成一棵树。
*   **树枝 (Branch)**：生成树 $T$ 中的边。
*   **弦 (Chord)**：$G$ 中不在生成树 $T$ 中的边（$E(G) - E(T)$）。
*   **余树 (Co-tree)**：由 $G$ 的所有弦导出的子图，记作 $\bar{T}$。
    *   *注意*：$\bar{T}$ 不一定连通，也不一定不含回路。

#### 2. 生成树的存在性
*   **定理**：无向图 $G$ 有生成树 **当且仅当** $G$ 是**连通图**。
    *   若是 $n$ 阶 $m$ 条边的连通图，生成树必定有 $n-1$ 条边（树枝），剩余 $m-n+1$ 条边是弦。

#### 3. 基本回路系统 (Fundamental Cycle System)
*   **定义**：设 $T$ 是 $G$ 的一棵生成树。若添加一条弦 $e$ 到 $T$ 中，必然形成**唯一**的一个圈。这个圈称为对应于弦 $e$ 的**基本回路**。
*   **基本回路系统**：所有弦（共 $m-n+1$ 条）对应的基本回路的集合。
    *   记作 $C_f$。
*   **圈秩 (Cycle Rank) / 零度**：图 $G$ 的基本回路的个数。
    $$ \xi(G) = m - n + 1 $$

#### 4. 基本割集系统 (Fundamental Cut-set System)
*   **定义**：设 $T$ 是 $G$ 的一棵生成树。若删去 $T$ 中的一条树枝 $e$，树被分成两个连通分量。此时，$e$ 加上所有连接这两个分量的弦，构成一个**割集**。这个割集称为对应于树枝 $e$ 的**基本割集**。
    *   *特征*：该割集中**只有一条树枝** $e$，其余全是弦。
*   **基本割集系统**：所有树枝（共 $n-1$ 条）对应的基本割集的集合。
    *   记作 $S_f$。
*   **割集秩 (Cut-set Rank)**：图 $G$ 的基本割集的个数。
    $$ \eta(G) = n - 1 $$

#### 5. 最小生成树 (Minimum Spanning Tree, MST)
*   **定义**：在连通带权图 $G$ 中，边权之和最小的生成树。
    $$ W(T) = \sum_{e \in E(T)} w(e) \quad \text{达到最小} $$
*   **避圈法 (Kruskal 算法)**：
    1.  将图 $G$ 中所有边按权值**从小到大**排序。
    2.  依次考察每条边：若这条边与已选的边**不构成回路**，则选中它；否则丢弃。
    3.  直到选中 $n-1$ 条边为止。

### 16.3 根树及其应用

#### 1. 有向树与根树
*   **有向树**：基图（忽略方向后的图）是无向树的有向图。
*   **根树 (Rooted Tree)**：
    *   **定义**：一个有向树，若恰有一个顶点的**入度为 0**（称为**树根**），其余所有顶点的**入度均为 1**。
    *   **树叶**：入度为 1，出度为 0 的顶点。
    *   **内点**：入度为 1，出度不为 0 的顶点。
    *   **分支点**：内点和树根统称为分支点。
*   **层数 (Level)**：从树根到顶点 $v$ 的通路长度（边数），记为 $l(v)$。树根层数为 0。
*   **树高 (Height)**：树中顶点的最大层数。

#### 2. 家族关系术语
*   **祖先/后代**：若 $v$ 到 $u$ 有通路，则 $v$ 是 $u$ 的祖先，$u$ 是 $v$ 的后代。
*   **父亲/儿子**：若有边 $\langle v, u \rangle$，则 $v$ 是 $u$ 的父亲，$u$ 是 $v$ 的儿子。
*   **兄弟**：同一个父亲的儿子互为兄弟。
*   **有序树**：若规定了每一层顶点左右次序的根树。

#### 3. $r$ 叉树 ($r$-ary Tree)
*   **$r$ 叉树**：每个分支点**至多**有 $r$ 个儿子的有序根树。
*   **$r$ 叉正则树**：每个分支点**恰好**有 $r$ 个儿子的有序根树。
*   **$r$ 叉完全正则树**：树叶层数均相同的 $r$ 叉正则树。

#### 4. 最优树与 Huffman 算法
*   **带权路径长度**：
    设树有 $t$ 个树叶，每个树叶 $v_i$ 带有权值 $w_i$，层数为 $l(v_i)$。树的带权路径长度 $W(T)$ 定义为：
    $$ W(T) = \sum_{i=1}^{t} w_i l(v_i) $$
*   **最优树 (Optimal Tree)**：在给定一组权值作为树叶的情况下，带权路径长度 $W(T)$ **最小**的二叉树。也称为 **Huffman 树**。
*   **Huffman 算法 (构造最优二叉树)**：
    1.  **构造森林**：将给定的 $t$ 个权值看作 $t$ 棵只有根节点的树。
    2.  **选取合并**：在森林中选取两个**根权值最小**的树，作为左右子树合并成一棵新树，新树根的权值为两个子树根权值之和。
    3.  **重复**：将新树放回森林，重复步骤 2，直到只剩下一棵树。

#### 5. 前缀码 (Prefix Code)
*   **前缀码**：一组二进制编码，其中任何一个码字都不是另一个码字的**前缀**（即开头部分）。
    *   *作用*：保证解码时无歧义，不需要分隔符。
*   **二叉树与前缀码**：
    *   可以用二叉树生成前缀码。
    *   **方法**：左分支标记 0，右分支标记 1。从根到树叶的路径上的标号序列即为该树叶对应字符的编码。
    *   利用 Huffman 树生成的编码称为 **Huffman 编码**（是最优前缀码，平均传输位数最少）。

#### 6. 二叉树的周游 (Traversal)与波兰符号
对二叉树顶点的访问顺序：
1.  **中序行遍** (In-order)：左子树 $\to$ 根 $\to$ 右子树。
    *   对应：**中缀符号法** (标准四则运算表达式，如 $A+B$)。
2.  **前序行遍** (Pre-order)：根 $\to$ 左子树 $\to$ 右子树。
    *   对应：**波兰符号法** (前缀表达式，如 $+AB$)。
    *   *优点*：无需括号即可唯一确定运算顺序。
3.  **后序行遍** (Post-order)：左子树 $\to$ 右子树 $\to$ 根。
    *   对应：**逆波兰符号法** (后缀表达式，如 $AB+$)。
    *   *优点*：适合计算机堆栈运算，无需括号。

## 第17章 平面图

### 17.1 平面图的基本概念

#### 1. 平面图与平面嵌入
*   **平面图 (Planar Graph)**：如果一个无向图 $G$ **能够**画在平面上，使得除顶点处外，边与边之间**没有交叉**，则称 $G$ 为可平面图，简称平面图。
*   **平面嵌入 (Plane Embedding)**：将平面图画在平面上，且边不相交的这种**画法**，称为图 $G$ 的平面嵌入（或平面表示）。
*   **非平面图**：无论怎样画，边与边之间都不可避免地产生交叉的图。
*   **重要实例**：
    *   **平面图**：$K_1, K_2, K_3, K_4$（完全图）、$K_{1,n}, K_{2,n}$（完全二部图）、所有树、所有圈。
    *   **非平面图**（极其重要）：
        *   **$K_5$**：5个顶点的完全图。
        *   **$K_{3,3}$**：两部分顶点数均为3的完全二部图。
*   **定理**：平面图的子图是平面图；非平面图的母图是非平面图。

#### 2. 面与边界
给定平面图 $G$ 的一个平面嵌入：
*   **面 (Face/Region)**：$G$ 的边将平面划分成的若干个区域。
    *   **无限面 / 外部面**：面积无限的那个区域，记作 $R_0$。
    *   **有限面 / 内部面**：面积有限的区域。
*   **边界 (Boundary)**：包围每个面的所有边组成的回路（或闭合路径）。
*   **面的次数 (Degree of a Face)**：
    *   **定义**：该面的边界长度（即边界上边的条数），记作 $\deg(R)$。
    *   **计算规则**：如果一条边是某个面边界上的**桥**（即该边两侧是同一个面），则计算该面次数时，这条边要**计算 2 次**。
*   **面的握手定理**：
    平面图所有面的次数之和等于边数的 2 倍。
    $$ \sum \deg(R) = 2m $$

#### 3. 极大平面图
*   **定义**：设 $G$ 是简单平面图，如果在 $G$ 的任意两个不相邻的顶点之间加一条边，所得的图均为非平面图，则称 $G$ 为**极大平面图**。
    *   *通俗理解*：边已经加满了，再加边就会交叉。
*   **性质**：
    1.  极大平面图是连通的。
    2.  若阶数 $n \ge 3$，则没有割点和桥。
*   **定理**：设 $G$ 是 $n(n \ge 3)$ 阶简单平面图，则 $G$ 为极大平面图 **当且仅当** $G$ 的每个面的次数均为 3（即每个面都是三角形）。
    *   因此极大平面图也被称为**三角剖分图**。

#### 4. 极小非平面图
*   **定义**：若图 $G$ 是非平面图，但删除其中任意一条边后，所得的图都是平面图，则称 $G$ 为**极小非平面图**。
*   **实例**：$K_5$ 和 $K_{3,3}$ 都是极小非平面图。

### 17.2 欧拉公式

#### 1. 欧拉公式 (Euler's Formula)
*   **欧拉公式**：设 $G$ 是**连通**平面图，顶点数为 $n$，边数为 $m$，面数为 $r$，则：
    $$ n - m + r = 2 $$
*   **欧拉公式的推广**：对于有 $k$ 个连通分支的平面图：
    $$ n - m + r = k + 1 $$

#### 2. 平面图的边数限制（必要条件）
用于判断一个图是否可能为平面图。如果违反以下不等式，则一定不是平面图。
设 $G$ 是连通平面图，且每个面的次数至少为 $l$ ($l \ge 3$)：

*   **一般公式**：
    $$ m \le \frac{l}{l-2}(n-2) $$
*   **简单平面图 ($l=3$)**：
    若 $G$ 是 $n(n \ge 3)$ 阶简单连通平面图，则：
    $$ m \le 3n - 6 $$
    *   *应用*：$K_5$ 有 $n=5, m=10$。$3(5)-6 = 9$。因为 $10 > 9$，所以 $K_5$ 不是平面图。
*   **极大平面图**：
    $$ m = 3n - 6 $$
*   **无三角形的平面图 ($l=4$)**：
    若 $G$ 是没有三角形（即没有长度为3的圈）的简单连通平面图（例如二部图），则每个面至少由 4 条边围成，有：
    $$ m \le 2n - 4 $$
    *   *应用*：$K_{3,3}$ 是二部图（无奇圈，l=4），$n=6, m=9$。$2(6)-4 = 8$。因为 $9 > 8$，所以 $K_{3,3}$ 不是平面图。

#### 3. 最小度定理
*   **定理**：设 $G$ 是简单平面图，则 $G$ 中至少存在一个度数小于等于 5 的顶点。
    $$ \delta(G) \le 5 $$

### 17.3 平面图的判断

#### 1. 同胚 (Homeomorphism)
*   **2度顶点插入/消去**：在图的边上插入一个度数为2的新顶点，或将一个度数为2的顶点及其关联的两条边合并为一条边。
*   **同胚定义**：若两个图 $G_1$ 和 $G_2$ 可以通过反复插入或消去 2 度顶点后变得**同构**，则称 $G_1$ 和 $G_2$ **同胚**。
    *   *直观理解*：同胚就是“橡皮筋图”，边可以拉长缩短，中间加点不影响结构。

#### 2. 库拉托夫斯基定理 (Kuratowski's Theorem)
这是判定平面图的充要条件。
*   **Kuratowski定理1**：图 $G$ 是平面图 **当且仅当** $G$ 中不包含**同胚**于 $K_5$ 或 $K_{3,3}$ 的子图。
*   **收缩 (Contraction)**：去掉一条边 $(u, v)$ 并将顶点 $u, v$ 合并为一个新顶点的操作。
*   **Kuratowski定理2 (瓦格纳定理)**：图 $G$ 是平面图 **当且仅当** $G$ 中没有可以**收缩**到 $K_5$ 或 $K_{3,3}$ 的子图。

### 17.4 平面图的对偶图

#### 1. 对偶图 (Dual Graph) 的构造
设 $G$ 是一个平面嵌入。构造其对偶图 $G^*$ 的规则如下：
1.  **点对画**：在 $G$ 的每一个面 $R_i$ 内部放置一个顶点 $v_i^*$。
2.  **边对边**：若 $G$ 的一条边 $e$ 是两个面 $R_i$ 和 $R_j$ 的公共边界，则在 $G^*$ 中画一条连接 $v_i^*$ 和 $v_j^*$ 的边 $e^*$，且 $e^*$ 穿过 $e$。
3.  **特殊情况**：若 $e$ 是面 $R_i$ 内部的桥（两侧是同一个面），则 $e^*$ 是以 $v_i^*$ 为顶点的环。

#### 2. 对偶图的性质
设 $G$ 是连通平面图，$G^*$ 是其对偶图：
*   **基本对应关系**：
    *   $G^*$ 的顶点数 $n^* =$ $G$ 的面数 $r$。
    *   $G^*$ 的边数 $m^* =$ $G$ 的边数 $m$。
    *   $G^*$ 的面数 $r^* =$ $G$ 的顶点数 $n$。
*   **度数关系**：$G^*$ 中顶点 $v_i^*$ 的度数等于 $G$ 中对应面 $R_i$ 的次数。
    $$ d_{G^*}(v_i^*) = \deg(R_i) $$
*   **结构性质**：
    *   $G^*$ 一定是平面图。
    *   若 $G$ 是连通的，则 $(G^*)^* \cong G$（对偶的对偶是原图）。
    *   $G$ 中的桥 $\leftrightarrow$ $G^*$ 中的环。
    *   $G$ 中的环 $\leftrightarrow$ $G^*$ 中的桥。

#### 3. 自对偶图
*   **定义**：若平面图 $G$ 与其对偶图 $G^*$ 同构 ($G \cong G^*$)，则称 $G$ 为自对偶图。
*   **例子**：轮图 $W_n$ (即 $n$ 阶轮图，有些教材记作 $n+1$ 个顶点的轮图) 通常是自对偶的。

## 第18章 支配集、覆盖集、独立集、匹配与着色

本章主要探讨图论中点与边的特殊集合及其计数问题。
*   **前3节**（支配集、覆盖集、独立集、匹配）讨论的对象是**无向简单图**。
*   **后3节**（着色）讨论的对象是**无环图**。

### 18.1 支配集、点覆盖集与点独立集

这三个概念都是针对**顶点 (Vertex)** 的集合。设 $G = \langle V, E \rangle$ 为无向简单图。

#### 1. 支配集 (Dominating Set)
*   **定义**：选出一个顶点子集 $V^*$，如果图里**剩下的**所有点，每一个都至少与 $V^*$ 中的某一个点**相邻**，那么 $V^*$ 就是支配集。
*   **极小支配集**：$V^*$ 是支配集，但如果去掉里面任何一个点，它就不是支配集了。
*   **最小支配集**：在所有支配集中，顶点数最少的那个。
*   **支配数**：最小支配集的顶点个数，记作 $\gamma_0(G)$ 或 $\gamma_0$。

#### 2. 点独立集 (Independent Set)
*   **定义**：选出一个顶点子集 $V^*$，如果 $V^*$ 里的任意两个点都**不相邻**（没有边直接相连），那么 $V^*$ 就是点独立集。
*   **极大点独立集**：$V^*$ 是独立集，但如果再往里面加任何一个图里的其他点，它就不是独立集了。
*   **最大点独立集**：在所有点独立集中，顶点数最多的那个。
*   **点独立数**：最大点独立集的顶点个数，记作 $\beta_0(G)$ 或 $\beta_0$。
*   **性质**：**极大**点独立集一定是**极小**支配集。

#### 3. 点覆盖集 (Vertex Covering)
*   **定义**：选出一个顶点子集 $V^*$，如果图里的**每一条边**，都至少有一个端点在 $V^*$ 里，那么 $V^*$ 就是点覆盖集。
*   **极小点覆盖**：$V^*$ 是覆盖集，但去掉任意一个点，就有边没被覆盖了。
*   **最小点覆盖**：在所有点覆盖集中，顶点数最少的那个。
*   **点覆盖数**：最小点覆盖的顶点个数，记作 $\alpha_0(G)$ 或 $\alpha_0$。

#### 4. 三者之间的关系（核心定理）
*   **覆盖与独立的关系**：
    一个集合 $V^*$ 是**点覆盖** $\Leftrightarrow$ 剩下的点 $V - V^*$ 是**点独立集**。
    *   *解释*：如果你选的点把所有边都堵住了（覆盖），那没选的点之间肯定没有边（独立）。
*   **数量关系公式**：
    对于 $n$ 阶无向图：
    $$ \alpha_0(G) + \beta_0(G) = n $$
    $$ \text{点覆盖数} + \text{点独立数} = \text{顶点总数} $$

### 18.2 边覆盖集与匹配

这部分讨论的是**边 (Edge)** 的集合。设 $G$ 是无向简单图。

#### 1. 边覆盖集 (Edge Covering)
*   **前提**：图中不能有**孤立点**（否则没法用边去覆盖它）。
*   **定义**：选出一个边子集 $E^*$，如果图里的**每一个顶点**，都至少是 $E^*$ 中某条边的端点，那么 $E^*$ 就是边覆盖集。
    *   *通俗理解*：选出一些边，让所有的顶点都至少连着一条选中的边。
*   **极小边覆盖**：去掉任何一条边就盖不住所有点了。
*   **最小边覆盖**：边数最少的边覆盖集。
*   **边覆盖数**：最小边覆盖的边数，记作 $\alpha_1(G)$ 或 $\alpha_1$。

#### 2. 匹配 / 边独立集 (Matching)
*   **定义**：选出一个边子集 $E^*$，如果 $E^*$ 中任意两条边都**不相邻**（没有公共端点），那么 $E^*$ 就是匹配（也叫边独立集）。
*   **极大匹配**：再加一条边进去就会出现公共端点了。
*   **最大匹配**：边数最多的匹配。
*   **匹配数**：最大匹配的边数，记作 $\beta_1(G)$ 或 $\beta_1$。

#### 3. 匹配的相关术语
设 $M$ 是一个匹配：
*   **匹配边**：在 $M$ 里的边。
*   **饱和点**：匹配边的端点。
*   **非饱和点**：不与任何匹配边关联的点。
*   **完美匹配**：所有顶点都是饱和点。
*   **交错路径**：一条路径，边是“非匹配、匹配、非匹配、匹配……”这样交替出现的。
*   **可增广交错路径**：一条**起点和终点都是非饱和点**的交错路径。
    *   *作用*：如果找到一条增广路径，把路径上的匹配边和非匹配边**互换**，匹配数就能 +1。
*   **Berge 定理**：$M$ 是最大匹配 $\Leftrightarrow$ 图中不存在关于 $M$ 的可增广交错路径。

#### 4. 边覆盖与匹配的关系（Gallai 定理）
*   **定理**：对于 $n$ 阶无向图（无孤立点）：
    $$ \alpha_1(G) + \beta_1(G) = n $$
    $$ \text{边覆盖数} + \text{匹配数} = \text{顶点总数} $$

### 18.3 二部图中的匹配

#### 1. 完备匹配与完美匹配
设二部图 $G = \langle V_1, V_2, E \rangle$，且 $|V_1| \le |V_2|$。
*   **完备匹配**：如果匹配 $M$ 的边数等于 $|V_1|$。
*   **完美匹配**：如果 $|V_1| = |V_2|$ 且存在完备匹配。

#### 2. 霍尔定理 (Hall's Marriage Theorem)
*   **判定条件**：二部图 $G$ 存在从 $V_1$ 到 $V_2$ 的完备匹配 $\Leftrightarrow$ $V_1$ 中任意 $k$ 个顶点，在 $V_2$ 中至少有 $k$ 个邻居。

#### 3. 充分条件 (t 条件)
*   如果 $V_1$ 中每个点至少连 $t$ 条边，$V_2$ 中每个点至多连 $t$ 条边，则一定存在完备匹配。

### 18.4 点着色

#### 1. 点着色定义
*   **定义**：给无向图的每个顶点涂一种颜色，要求**相邻的顶点颜色不同**。
*   **$k$-可着色**：如果能用 $k$ 种颜色完成上述要求。
*   **色数**：完成着色所需的**最少**颜色数，记作 $\chi(G)$。

#### 2. 常见图的色数
*   **完全图 $K_n$**：$\chi(K_n) = n$ （每个人都互连，必须每人一个色）。
*   **偶圈**（长度为偶数的回路）：$\chi = 2$。
*   **奇圈**（长度为奇数的回路）：$\chi = 3$。
*   **二部图**：$\chi = 2$ （只要至少有一条边）。

#### 3. 色数的界限
设 $\Delta(G)$ 为图的最大度数。
*   **一般上界**：$\chi(G) \le \Delta(G) + 1$。
    *   *解释*：最坏情况，一个点周围有 $\Delta$ 个邻居，只要我有第 $\Delta+1$ 种颜色，就能跟它们都不一样。
*   **布鲁克斯定理 (Brooks' Theorem)**：
    如果 $G$ 是连通图，且**不是**完全图，也**不是**奇圈，则：
    $$ \chi(G) \le \Delta(G) $$

### 18.5 地图着色与平面图的点着色

#### 1. 地图着色
*   **定义**：给平面地图的区域涂色，相邻区域（有公共边界线，不能光是一个点）颜色不同。
*   **转化**：地图着色问题 $\Leftrightarrow$ 该地图的**对偶图**（平面图）的**点着色**问题。
    *   区域变点，相邻变连线。

#### 2. 四色定理
*   **定理**：任何平面图都是 **4-可着色**的。
    $$ \chi(G) \le 4 \quad (\text{对于平面图}) $$
*   *历史意义*：证明了地图着色只需 4 种颜色。

### 18.6 边着色

#### 1. 边着色定义
*   **定义**：给无向图的每条边涂一种颜色，要求**相邻的边**（即有公共端点的边）颜色不同。
*   **边色数**：完成边着色所需的**最少**颜色数，记作 $\chi'(G)$。

#### 2. 维泽定理 (Vizing's Theorem)
设 $\Delta$ 为图的最大度数。简单图的边色数只有两种可能：
1.  **第一类图**：$\chi'(G) = \Delta$。
2.  **第二类图**：$\chi'(G) = \Delta + 1$。
*   **结论**：$\Delta \le \chi'(G) \le \Delta + 1$。

#### 3. 二部图的边着色
*   **定理**：二部图一定是第一类图。
    $$ \chi'(G) = \Delta(G) \quad (\text{若 G 为二部图}) $$